{% extends 'main/base2.html' %}
{% load static %}

{% block title %}<title>Профиль</title>{% endblock %}
{% block stylesheet %}
    <link rel="stylesheet" href="{% static 'account/css/profile.css' %}">
{% endblock %}

{% block main %}
<div class="container">
    <div class="main-body">
    
         
          <!-- /Breadcrumb -->
    
          <div class="row gutters-sm">
            <div class="col-md-4 mb-3">
              <div class="card">
                <div class="card-body">
                  <div class="d-flex flex-column align-items-center text-center">
                    {% if user_prof.photo %}
                    <img src="{{ user_prof.photo.url }}" alt="Фотография пользователя"  width="200">                
                    {% else %}
                    <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle" width="150">
                    {% endif %}
                    
                    <div class="mt-3">
                      <h4>{{ user.username }}</h4>                     
                      <p class="text-secondary mb-1">{{ user.profile.group }}</p>                     
                      <p class="text-muted font-size-sm">КГУ им.Циолковского</p>
                      <a href="{% url 'main:add' %}"><button class="btn btn-primary">Новость</button></a>
                      <a href="{% url 'main:create_product' %}"><button class="btn btn-outline-primary">Товар</button></a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card mt-3">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                    <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe mr-2 icon-inline"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line>
                      <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg> Website</h6>
                    <a href="https://tksu.ru/" style="text-decoration: none;" target="_blank" class="text-secondary">КГУ им. К.Э. Циолковского</a>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                    <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 48 48">
                      <path fill="#1976d2" d="M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5 V37z"></path><path fill="#fff" d="M35.937,18.041c0.046-0.151,0.068-0.291,0.062-0.416C35.984,17.263,35.735,17,35.149,17h-2.618 c-0.661,0-0.966,0.4-1.144,0.801c0,0-1.632,3.359-3.513,5.574c-0.61,0.641-0.92,0.625-1.25,0.625C26.447,24,26,23.786,26,23.199 v-5.185C26,17.32,25.827,17,25.268,17h-4.649C20.212,17,20,17.32,20,17.641c0,0.667,0.898,0.827,1,2.696v3.623 C21,24.84,20.847,25,20.517,25c-0.89,0-2.642-3-3.815-6.932C16.448,17.294,16.194,17,15.533,17h-2.643 C12.127,17,12,17.374,12,17.774c0,0.721,0.6,4.619,3.875,9.101C18.25,30.125,21.379,32,24.149,32c1.678,0,1.85-0.427,1.85-1.094 v-2.972C26,27.133,26.183,27,26.717,27c0.381,0,1.158,0.25,2.658,2c1.73,2.018,2.044,3,3.036,3h2.618 c0.608,0,0.957-0.255,0.971-0.75c0.003-0.126-0.015-0.267-0.056-0.424c-0.194-0.576-1.084-1.984-2.194-3.326 c-0.615-0.743-1.222-1.479-1.501-1.879C32.062,25.36,31.991,25.176,32,25c0.009-0.185,0.105-0.361,0.249-0.607 C32.223,24.393,35.607,19.642,35.937,18.041z"></path>
                      </svg> ВКонтакте</h6>
                    <a href="https://vk.com/kgu_kaluga" style="text-decoration: none;" target="_blank" class="text-secondary">Мы ВКонтакте!</a>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                    <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 48 48">
                      <path fill="#29b6f6" d="M24 4A20 20 0 1 0 24 44A20 20 0 1 0 24 4Z"></path><path fill="#fff" d="M33.95,15l-3.746,19.126c0,0-0.161,0.874-1.245,0.874c-0.576,0-0.873-0.274-0.873-0.274l-8.114-6.733 l-3.97-2.001l-5.095-1.355c0,0-0.907-0.262-0.907-1.012c0-0.625,0.933-0.923,0.933-0.923l21.316-8.468 c-0.001-0.001,0.651-0.235,1.126-0.234C33.667,14,34,14.125,34,14.5C34,14.75,33.95,15,33.95,15z"></path><path fill="#b0bec5" d="M23,30.505l-3.426,3.374c0,0-0.149,0.115-0.348,0.12c-0.069,0.002-0.143-0.009-0.219-0.043 l0.964-5.965L23,30.505z"></path><path fill="#cfd8dc" d="M29.897,18.196c-0.169-0.22-0.481-0.26-0.701-0.093L16,26c0,0,2.106,5.892,2.427,6.912 c0.322,1.021,0.58,1.045,0.58,1.045l0.964-5.965l9.832-9.096C30.023,18.729,30.064,18.416,29.897,18.196z"></path>
                      </svg>Телеграм</h6>
                    <a href="https://t.me/ksu_kaluga" style="text-decoration: none;" target="_blank" class="text-secondary">Мы в Телеграм!</a>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                    <h6 class="mb-0"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-instagram mr-2 icon-inline text-danger"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                      <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg> Instagram</h6>
                    <a href="https://www.instagram.com/kaluga_state_university/" style="text-decoration: none;" target="_blank" class="text-secondary">Мы в Инстаграм!</a>
                  </li>                
                </ul>
              </div>
            </div>
            <div class="col-md-8">
              <div class="card mb-3">
                <div class="card-body">
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Полное имя</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                        {{ user.first_name }} {{ user.last_name }}
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Email</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                        {{ user.email }}
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Номер договора</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                        {{ user_prof.contract_number }}
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Номер студенческого</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                        {{ user_prof.student_ID }}
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-sm-3">
                      <h6 class="mb-0">Комната</h6>
                    </div>
                    <div class="col-sm-9 text-secondary">
                        {{ user_prof.room }}
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-sm-12">
                      <a class="btn btn-info "  href="{% url 'account:edit_profile' %}">Редактировать</a>
                    </div>
                  </div>
                </div>

                

              </div>

              <div class="row gutters-sm">
                <div class="col-sm-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h4 class="d-flex align-items-center mb-3">Ваши новости</h4>        
                      
                      
                  <ul style="list-style: none;">
                      {% for news in user_news %}
                          <li style="padding: 4px 0px; border-bottom: solid black 2px;">
                              <h6><a class="text-muted text-decoration-none" href="{{ news.get_absolute_url }}">{{ news.title }}</a>
                              </h6><div>

                                <!-- кнопка обновить -->
                                <a class="text-muted text-decoration-none" href="{{ news.get_absolute_update_url }}">
                                  <button style="margin: 5px;" type="submit" class="delbut update noselect">
                                    <span class='text'>Обновить</span>
                                    <span class="icon">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-capslock-fill" viewBox="0 0 16 16">
                                        <path d="M7.27 1.047a1 1 0 0 1 1.46 0l6.345 6.77c.6.638.146 1.683-.73 1.683H11.5v1a1 1 0 0 1-1 1h-5a1 1 0 0 1-1-1v-1H1.654C.78 9.5.326 8.455.924 7.816L7.27 1.047zM4.5 13.5a1 1 0 0 1 1-1h5a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1h-5a1 1 0 0 1-1-1v-1z"/>
                                      </svg>
                                    </span>
                                 </button>
                               </a>
                              <!-- --------------------------------------------------------- -->
                              

                              <!-- кнопка удалить -->
                                <form method="post" id="delete-news-form" action="{{ news.get_absolute_delete_url }}"  id="delete-news-form">
                                    {% csrf_token %}

                                    <button style="margin: 5px;" type="submit" onclick="confirmDelete()" class="delete-news-button delbut noselect" name="confirm_delete" value="1" ><span class='text'>Удалить                                      
                                      </span>
                                        <span class="icon">
                                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                                            <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                                          </svg>

                                      </span>
                                    </button>
                                </form>
                                
                              </div>
                              
                            
                          <!-- --------------------------------------------------------- -->
                            
                          </li>
                      {% empty %}
                          <p>У вас пока нет новостей.</p>
                      {% endfor %}
                  </ul>
                                 

                    </div>
                        </div>
                  
                </div>
                <div class="col-sm-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h4 class="d-flex align-items-center mb-3">Ваши товары</h4>
                      <ul style=" list-style: none;">
                        {% for product in user_product %}
                            <li style=" text-decoration: none; padding: 4px 0px; border-bottom: solid black 2px;">
                                <h6><a class="text-muted text-decoration-none" href="{{ product.get_absolute_url }}">{{ product.name }}</a></h6>

                                  <!-- кнопка обновить -->
                                  <a class="text-muted text-decoration-none" href="{{ product.get_absolute_update_url }}"><button style="margin: 5px;" type="submit" class="delbut update noselect"><span class='text'>Обновить                                      
                                  </span>
                                    <span class="icon">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-capslock-fill" viewBox="0 0 16 16">
                                        <path d="M7.27 1.047a1 1 0 0 1 1.46 0l6.345 6.77c.6.638.146 1.683-.73 1.683H11.5v1a1 1 0 0 1-1 1h-5a1 1 0 0 1-1-1v-1H1.654C.78 9.5.326 8.455.924 7.816L7.27 1.047zM4.5 13.5a1 1 0 0 1 1-1h5a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1h-5a1 1 0 0 1-1-1v-1z"/>
                                      </svg>
  
                                  </span>
                                </button>
                              </a>
                                <!-- --------------------------------------------------------- -->
                                
  
                                <!-- кнопка удалить -->
                                  <form method="post" id="delete-news-form" action="{{ product.get_absolute_delete_url }}"  id="delete-news-form">
                                      {% csrf_token %}
  
                                      <button style="margin: 5px;" type="submit" onclick="confirmDelete()" class="delete-news-button delbut noselect" name="confirm_delete" value="1" ><span class='text'>Удалить                                      
                                        </span>
                                          <span class="icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                                              <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                                            </svg>
  
                                        </span>
                                      </button>
                                  </form>
                                  
                                



                            </li>
                        {% empty %}
                            <p>У вас пока нет опубликованных товаров.</p>
                        {% endfor %}
                    </ul>
                    </div>
                  </div>
                </div>
              </div>



            </div>
          </div>

        </div>
    </div>

    <script>
      function confirmDelete() {
          if (confirm('Вы действительно хотите удалить запись?')) {                                      
              document.getElementById('delete-news-form').submit();
          
          }
          else {
              event.preventDefault();
              return false;
          }
      }
  </script>
    {% endblock %}